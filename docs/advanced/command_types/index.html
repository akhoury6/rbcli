<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.55.6" />
    <meta name="description" content="">


    <link rel="icon" href="/rbcli/images/favicon.png" type="image/png">

    <title>Command Types :: RBCli Documentation</title>

    
    <link href="/rbcli/css/nucleus.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/fontawesome-all.min.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/hybrid.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/featherlight.min.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/perfect-scrollbar.min.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/auto-complete.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/atom-one-dark-reasonable.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/theme.css?1561064272" rel="stylesheet">
    <link href="/rbcli/css/hugo-theme.css?1561064272" rel="stylesheet">
    
      <link href="/rbcli/css/theme-blue.css?1561064272" rel="stylesheet">
    

    <script src="/rbcli/js/jquery-3.3.1.min.js?1561064272"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/rbcli/advanced/command_types/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://akhoury6.github.io/rbcli/" style="font-size: 40px">
  <span class="fas fa-terminal"></span>&nbsp;ùöÅùô±ùô≤ùöïùöí
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/rbcli/js/lunr.min.js?1561064272"></script>
<script type="text/javascript" src="/rbcli/js/auto-complete.js?1561064272"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/akhoury6.github.io\/rbcli\/";
    
</script>
<script type="text/javascript" src="/rbcli/js/search.js?1561064272"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/rbcli/quick_reference/" title="Quick Reference" class="dd-item 
        
        
        
        ">
      <a href="/rbcli/quick_reference/">
          Quick Reference
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/rbcli/tutorial/" title="Tutorial" class="dd-item 
        
        
        
        ">
      <a href="/rbcli/tutorial/">
          Tutorial
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/rbcli/tutorial/10-getting_started/" title="Getting Started" class="dd-item ">
        <a href="/rbcli/tutorial/10-getting_started/">
        <b>1. </b>Getting Started
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/tutorial/20-project_layout/" title="The Project Layout" class="dd-item ">
        <a href="/rbcli/tutorial/20-project_layout/">
        <b>2. </b>The Project Layout
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/tutorial/30-your_first_command/" title="Your First Command" class="dd-item ">
        <a href="/rbcli/tutorial/30-your_first_command/">
        <b>3. </b>Your First Command
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/tutorial/40-options_parameters_and_arguments/" title="Options, Parameters, and Arguments" class="dd-item ">
        <a href="/rbcli/tutorial/40-options_parameters_and_arguments/">
        <b>4. </b>Options, Parameters, and Arguments
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/tutorial/50-publishing/" title="Publishing Your Application" class="dd-item ">
        <a href="/rbcli/tutorial/50-publishing/">
        <b>5. </b>Publishing Your Application
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/rbcli/advanced/" title="Advanced" class="dd-item 
        parent
        
        
        ">
      <a href="/rbcli/advanced/">
          Advanced
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/automatic_updates/" title="Automatic Updates" class="dd-item ">
        <a href="/rbcli/advanced/automatic_updates/">
        Automatic Updates
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/command_types/" title="Command Types" class="dd-item active">
        <a href="/rbcli/advanced/command_types/">
        Command Types
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/distributed_state_locking/" title="Distributed State and Locking" class="dd-item ">
        <a href="/rbcli/advanced/distributed_state_locking/">
        Distributed State and Locking
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/hooks/" title="Execution Hooks" class="dd-item ">
        <a href="/rbcli/advanced/hooks/">
        Execution Hooks
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/interactive_commands/" title="Interactive Commands" class="dd-item ">
        <a href="/rbcli/advanced/interactive_commands/">
        Interactive Commands
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/logging/" title="Logging" class="dd-item ">
        <a href="/rbcli/advanced/logging/">
        Logging
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/remote_execution/" title="Remote Execution" class="dd-item ">
        <a href="/rbcli/advanced/remote_execution/">
        Remote Execution
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/state_storage/" title="State Storage" class="dd-item ">
        <a href="/rbcli/advanced/state_storage/">
        State Storage
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/advanced/user_config_files/" title="User Configuration Files" class="dd-item ">
        <a href="/rbcli/advanced/user_config_files/">
        User Configuration Files
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/rbcli/development/" title="Development" class="dd-item 
        
        
        
        ">
      <a href="/rbcli/development/">
          Development
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/rbcli/development/contributing/" title="Contribution Guide" class="dd-item ">
        <a href="/rbcli/development/contributing/">
        Contribution Guide
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/development/license/" title="License Info" class="dd-item ">
        <a href="/rbcli/development/license/">
        License Info
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/development/code_of_conduct/" title="Code of Conduct" class="dd-item ">
        <a href="/rbcli/development/code_of_conduct/">
        Code of Conduct
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rbcli/development/changelog/" title="Changelog" class="dd-item ">
        <a href="/rbcli/development/changelog/">
        Changelog
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/rbcli/whoami/" title="My Letter To You" class="dd-item 
        
        
        
        ">
      <a href="/rbcli/whoami/">
          My Letter To You
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/akhoury6/rbcli"><i class='fab fa-github'></i> Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://rubygems.org/gems/rbcli"><i class='far fa-gem'></i> Rubygems</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/rbcli/'></a> > <a href='/rbcli/advanced/'>Advanced</a> > Command Types
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#general-command-structure">General Command Structure</a></li>
<li><a href="#standard-commands">Standard Commands</a></li>
<li><a href="#scripted-commands">Scripted Commands</a></li>
<li><a href="#external-commands">External Commands</a>
<ul>
<li><a href="#direct-path-mode">Direct Path Mode</a></li>
<li><a href="#variable-path-mode">Variable Path Mode</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Command Types
            </h1>
          

        





<p>RBCli has three different command types:</p>

<ul>
<li><strong>Standard Commands</strong> (Ruby-based)</li>
<li><strong>Scripted Commands</strong> (Ruby+Bash based)</li>
<li><strong>External Commands</strong> (Wrapping a 3rd party application)</li>
</ul>

<p>This document is provided to be a reference. If you would like an in-depth tutorial, please see <a href="/rbcli/tutorial/30-your_first_command/">Your First Command</a>.</p>

<h2 id="general-command-structure">General Command Structure</h2>

<p>Commands in RBCli are created by subclassing <code>Rbcli::Command</code>. All commands share a certain common structure:</p>

<pre><code class="language-ruby">class List &lt; Rbcli::Command                                                           # Declare a new command by subclassing Rbcli::Command
	description 'TODO: Description goes here'                                           # (Required) Short description for the global help
	usage &lt;&lt;-EOF
TODO: Usage text goes here
EOF                                                                                   # (Required) Long description for the command-specific help
	parameter :force, 'Force testing', type: :boolean, default: false, required: false  # (Optional, Multiple) Add a command-specific CLI parameter. Can be called multiple times

	config_default :myopt2, description: 'My Option #2', default: 'Default Value Here'  # (Optional, Multiple) Specify an individual configuration parameter and set a default value. These will also be included in generated user config.
                                                                                      # Alternatively, you can simply create a yaml file in the `default_user_configs` directory in your project that specifies the default values of all options
end
</code></pre>

<ul>
<li><code>description</code>

<ul>
<li>A short description of the command, which will appear in the top-level help (when the user runs <code>mytool -h</code>).</li>
</ul></li>
<li><code>usage</code>

<ul>
<li>A description of how the command is meant to be used. This description can be as long as you want, and can be as in-depth as you&rsquo;d like. It will show up as a long, multi-line description when the user runs the command-sepcific help (<code>mytool list -h</code>).</li>
</ul></li>
<li><code>parameter</code>

<ul>
<li>Command-line tags that the user can enter that are specific to only this command. We will get into these in the next section on <a href="/rbcli/tutorial/40-options_parameters_and_arguments/">Options, Parameters, and Arguments</a></li>
</ul></li>
<li><code>config_default</code>

<ul>
<li>This sets a single item in the config file that will be made available to the user. More information can be found in the documentation on <a href="/rbcli/advanced/user_config_files/">User Config Files</a></li>
</ul></li>
</ul>

<h2 id="standard-commands">Standard Commands</h2>

<p>Standard commands are written as ruby code. To create a standard command called <code>list</code>, run:</p>

<pre><code class="language-bash">rbcli command --name=list
#or
rbcli command -n list
</code></pre>

<p>A standard command can be identified by the presence of an <code>action</code> block in the definition:</p>

<pre><code class="language-ruby">class List &lt; Rbcli::Command
	action do |params, args, global_opts, config|
		# Code goes here
	end
end
</code></pre>

<p>Your application&rsquo;s <strong>parameters</strong>, <strong>arguments</strong>, <strong>options</strong>, and <strong>config</strong> are available in the variables passed into the block. For more information on these, see <a href="/rbcli/tutorial/40-options_parameters_and_arguments/">Options, Parameters, and Arguments</a>.</p>

<h2 id="scripted-commands">Scripted Commands</h2>

<p>Scripted commands are part Ruby, part Bash scripting. They are a good choice to use if you feel something might be easier or more performant to script with Bash, or if you already have a Bash script you&rsquo;d like to use in your project. You can create one with:</p>

<pre><code class="language-bash">rbcli script -n list
</code></pre>

<p>This will create two files in your RBCli project: a Ruby file with the common command declaration (see <a href="#general-command-structure">General Command Structure</a>), and a bash script in the folder <code>application/commands/scripts/</code>.</p>

<p>You can tell a command is a script by the line:</p>

<pre><code class="language-ruby">class List &lt; Rbcli::Command
	script
end
</code></pre>

<p>RBCli will pass along your applications config and CLI parameters through JSON environment variables. To make things easy, a Bash library is provided that makes retrieving and parsing these variables easy. It is already imported when you generate the command, with the line:</p>

<pre><code class="language-bash">source $(echo $(cd &quot;$(dirname $(gem which rbcli))/../lib-sh&quot; &amp;&amp; pwd)/lib-rbcli.sh)
</code></pre>

<p>This will find the library which is stored on the system as part of the RBCli gem.</p>

<p>You can then retrieve the values present in your variables like such:</p>

<pre><code class="language-bash">rbcli params
rbcli args
rbcli global_opts
rbcli config
rbcli myvars

echo &quot;Usage Examples:&quot;
echo &quot;Log Level:  $(rbcli config .logger.log_level)&quot;
echo &quot;Log Target: $(rbcli config .logger.log_target)&quot;
echo &quot;First Argument (if passed): $(rbcli args .[0])&quot;
</code></pre>

<p>For your convenience, the script will have all the instructions needed there. For more instructions on how to use JQ syntax to parse values, see the <a href="https://stedolan.github.io/jq/manual/">JQ documentation</a>.</p>

<h2 id="external-commands">External Commands</h2>

<p>External Commands are used to wrap 3rd party applications. RBCli accomplishes this by allowing you to set environment variables and command line parameters based on your input variables.</p>

<p>RBCli provides this feature through the <code>extern</code> keyword. It provides two modes &ndash; <strong>direct path</strong> and <strong>variable path</strong> &ndash; which work similarly.</p>

<h3 id="direct-path-mode">Direct Path Mode</h3>

<p>Direct path mode is the simpler mode of the two External Command modes. It allows you to provide a specific command with environment variables set, though it does not allow using RBCli parameters, arguments, options, and config.</p>

<pre><code class="language-ruby">class List &lt; Rbcli::Command
 	extern path: 'path/to/application', envvars: {MYVAR: 'some_value'}                               # (Required) Runs a given application, with optional environment variables, when the user runs the command.
end
</code></pre>

<p>Here, we supply a string to run the command. We can optioanlly provide environment variables which will be set for the external application.</p>

<h3 id="variable-path-mode">Variable Path Mode</h3>

<p>Variable Path mode works the same as Direct Path Mode, only instead of providing a string we provide a block that returns a string (which will be the command executed). This allows us to generate different commands based on the CLI parameters that the user passed, or pass configuration as CLI parameters to the external application:</p>

<pre><code class="language-ruby">class Test &lt; Rbcli::Command
	extern envvars: {MY_OTHER_VAR: 'another_value'} do |params, args, global_opts, config|          # Alternate usage. Supplying a block instead of a path allows us to modify the command based on the arguments and configuration supplied by the user. This allows passing config settings as command line arguments to external applications. The block must return a string, which is the command to be executed.
		cmd = '/path/to/application'
		cmd += ' --test-script foo --ignore-errors' if params[:force]
		cmd
	end
end
</code></pre>

<p><strong>NOTE</strong>: Passing user-supplied data as part of the command string may be a security risk (example: <code>/path/to/application --name #{params[:name]}</code>). It is highly recommended to provide the fixed strings yourself, and only select which strings are used based on the variables provided. This is demonstrated in the example above.</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/rbcli/advanced/automatic_updates/" title="Automatic Updates"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/rbcli/advanced/distributed_state_locking/" title="Distributed State and Locking" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/rbcli/js/clipboard.min.js?1561064272"></script>
    <script src="/rbcli/js/perfect-scrollbar.min.js?1561064272"></script>
    <script src="/rbcli/js/perfect-scrollbar.jquery.min.js?1561064272"></script>
    <script src="/rbcli/js/jquery.sticky.js?1561064272"></script>
    <script src="/rbcli/js/featherlight.min.js?1561064272"></script>
    <script src="/rbcli/js/html5shiv-printshiv.min.js?1561064272"></script>
    <script src="/rbcli/js/highlight.pack.js?1561064272"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/rbcli/js/modernizr.custom-3.6.0.js?1561064272"></script>
    <script src="/rbcli/js/learn.js?1561064272"></script>
    <script src="/rbcli/js/hugo-learn.js?1561064272"></script>

    <link href="/rbcli/mermaid/mermaid.css?1561064272" rel="stylesheet" />
    <script src="/rbcli/mermaid/mermaid.js?1561064272"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

